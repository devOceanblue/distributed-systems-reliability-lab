# B-0303 — 이벤트 Envelope + Avro 스키마 + Registry 연동

## Goal
스키마/호환성/Consumer-first 실험을 위해 Avro + Schema Registry를 기본 이벤트 계약으로 채택한다.

## Scope
- 공통 Event Envelope 스키마 정의(Avro)
- `AccountBalanceChanged` 이벤트 스키마 v1 정의
- 스키마 레지스트리 등록/호환성 모드 설정 문서화
- Java 공통 모듈 제공:
  - serializer/deserializer 설정
  - 공통 헤더/trace_id
  - dedup_key 필수 검증

## Event Envelope (필수 필드)
- event_id (uuid)
- dedup_key (tx_id)
- event_type
- schema_version
- occurred_at (epoch millis)
- trace_id (optional)
- payload (union or nested record)

## Deliverables
- `contracts/avro/event-envelope.avsc`
- `contracts/avro/account-balance-changed-v1.avsc`
- `libs/event-core` 모듈:
  - event builder
  - failpoint helper(공통)

## Acceptance Criteria
- Schema Registry에 스키마 등록이 자동/수동으로 가능
- producer/consumer가 Avro로 메시지 송수신 성공
- dedup_key 누락 시 producer/consumer가 명확히 실패(로그에 사유)
