# B-0321 — Experiment E-001: ✅ Outbox + Relay + processed_event + invalidation 성공 케이스

## Goal
운영 표준을 모두 적용했을 때:
- 중복이 발생해도 결과는 1회
- 캐시 stale이 빠르게 해소(DEL/versioned)
- 유실이 발생하지 않음
을 증명한다.

## Setup
- PRODUCE_MODE=outbox
- consumer: IDEMPOTENCY_MODE=processed_table
- query: CACHE_INVALIDATION_MODE=DEL(or VERSIONED), TTL=30s, jitter=5s
- relay: failpoint OFF

## Steps
1) 10 accounts seed
2) 각 account에 deposit 100건(총 1000건)
3) relay/consumer 정상 처리 대기
4) assert:
   - ledger rows == 1000
   - processed_event rows == 1000
   - projection balance == expected sum
   - query-service hit ratio가 증가(선택)

## Expected
- 중복/유실 없음
- stale 없음(업데이트 직후 조회 시 최신)

## Deliverables
- `experiments/E-001-success.md`
- `scripts/assert/E-001.sh`
