# B-0322 — Experiment E-002: ❌ Outbox 없이 direct-produce + 크래시로 이벤트 유실

## Goal
Outbox가 없으면 DB commit 이후 크래시로 이벤트가 유실되어 projection/cache가 stale/불일치해짐을 재현한다.

## Setup
- command-service: PRODUCE_MODE=direct
- failpoint: FAILPOINT_AFTER_DB_COMMIT_BEFORE_KAFKA_SEND=true (1회만 발동하도록)
- consumer/relay는 정상이어도 됨(혹은 relay 미사용)

## Steps
1) account A에 deposit(tx1, +1000) 요청
2) DB에는 반영되지만 producer가 publish 전에 종료됨
3) consumer/projection은 업데이트되지 않음
4) assert:
   - account(domain) balance 증가
   - projection balance는 증가하지 않음
   - query-service는 stale(또는 projection 기준으로 틀림)

## Expected
- “DB에는 있는데 이벤트는 없다” 상태 재현
- 운영에서 왜 Outbox가 필요한지 실험으로 증명

## Deliverables
- `experiments/E-002-loss.md`
- `scripts/assert/E-002.sh`
